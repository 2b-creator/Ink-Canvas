<Window x:Class="Ink_Canvas.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" Topmost="True" KeyDown="Window_KeyDown"
        xmlns:local="clr-namespace:Ink_Canvas" xmlns:ui="http://schemas.modernwpf.com/2019"
        AllowsTransparency="True" WindowStyle="None" ResizeMode="NoResize"
        mc:Ignorable="d" WindowState="Maximized" Loaded="Window_Loaded" Background="Transparent" ShowInTaskbar="False"
        Title="Ink Canvas 画板" Height="1000" Width="1000" FontFamily="Microsoft YaHei UI"
        Foreground="Black" Stylus.IsPressAndHoldEnabled="False">
    <!--资源中添加命令-->
    <Window.Resources>
        <RoutedUICommand x:Key="KeyExit" Text=" "/>
        <RoutedUICommand x:Key="back_HotKey_Command" Text=" "/>
    </Window.Resources>
    <!--输入命令绑定-->
    <Window.InputBindings>
        <KeyBinding Gesture="Shift+Esc" Command="{StaticResource KeyExit}"/>
        <KeyBinding Modifiers="Ctrl" Key="Z" Command="{StaticResource back_HotKey_Command}"/>
    </Window.InputBindings>
    <!--命令执行方法绑定-->
    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource back_HotKey_Command}"
                    CanExecute="CommandBinding_CanExecute"
                    Executed="back_HotKey"/>
        <CommandBinding Command="{StaticResource KeyExit}"
                    CanExecute="CommandBinding_CanExecute"
                    Executed="KeyExit"/>
    </Window.CommandBindings>
    <Grid x:Name="Main_Grid" Background="#01FFFFFF" PreviewKeyDown="Main_Grid_PreviewKeyDown">
        <Grid Name="GridBackgroundCoverHolder">
            <Grid Name="GridBackgroundCover" Visibility="Visible" Background="#1F1F1F"/>
        </Grid>
        <Canvas Name="Canvas"/>
        <Label Name="Label" Visibility="Collapsed" Content="0"/>
        <InkCanvas x:Name="inkCanvas" Background="Transparent" Cursor="Pen" ForceCursor="False"
                   TouchUp="Main_Grid_TouchUp" TouchDown="Main_Grid_TouchDown"
                   TouchMove="inkCanvas_TouchMove"
                   ManipulationDelta="Main_Grid_ManipulationDelta"
                   ManipulationCompleted="Main_Grid_ManipulationCompleted"
                   ManipulationInertiaStarting="inkCanvas_ManipulationInertiaStarting"
                   IsManipulationEnabled="True" EditingModeChanged="inkCanvas_EditingModeChanged"
                   PreviewTouchDown="inkCanvas_PreviewTouchDown"
                   PreviewTouchUp="inkCanvas_PreviewTouchUp"
                   MouseDown="inkCanvas_MouseDown" MouseMove="inkCanvas_MouseMove" MouseUp="inkCanvas_MouseUp"
                   ManipulationStarting="inkCanvas_ManipulationStarting"
                   SelectionChanged="inkCanvas_SelectionChanged"
                   StrokeCollected="inkCanvas_StrokeCollected">
            <!--<InkCanvas.DefaultDrawingAttributes>
                <DrawingAttributes StylusTip="Ellipse" Height="8" Width="4" IgnorePressure="False" FitToCurve="True" >
                    <DrawingAttributes.StylusTipTransform>
                        <Matrix M11="1" M12="1.5" M21="2.2" M22="1"/>
                    </DrawingAttributes.StylusTipTransform>
                </DrawingAttributes>
            </InkCanvas.DefaultDrawingAttributes>-->
        </InkCanvas>
        <Grid Name="GridInkCanvasSelectionCover"
              MouseDown="GridInkCanvasSelectionCover_MouseDown"
              MouseUp="GridInkCanvasSelectionCover_MouseUp"
              IsManipulationEnabled="True"
              ManipulationStarting="GridInkCanvasSelectionCover_ManipulationStarting"
              ManipulationCompleted="GridInkCanvasSelectionCover_ManipulationCompleted"
              ManipulationDelta="GridInkCanvasSelectionCover_ManipulationDelta"
              PreviewTouchDown="GridInkCanvasSelectionCover_PreviewTouchDown"
              PreviewTouchUp="GridInkCanvasSelectionCover_PreviewTouchUp"
              TouchDown="GridInkCanvasSelectionCover_TouchDown"
              TouchUp="GridInkCanvasSelectionCover_TouchUp"
              Background="#01FFFFFF" Opacity="0.01" Visibility="Collapsed"/>

        <Grid Visibility="Collapsed">
            <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
                <Viewbox Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6" MouseUp="GridPPTControlPrevious_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Width="36" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6" MouseUp="GridPPTControlNext_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>
        <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BtnWhiteBoardAdd_Click" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Symbol="Add" Foreground="#FF666666" />
                        </Viewbox>
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchPrevious_Click" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}"/>
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                        </Grid>
                    </Border>
                    <Border Height="36" CornerRadius="2" Margin="0,0">
                        <TextBlock Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}"
                                   Foreground="White"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   FontFamily="Microsoft YaHei UI" FontSize="12"/>
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchNext_Click" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}"/>
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                        </Grid>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BorderMultiTouchMode_MouseUp" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Name="SymbolIconMultiTouchMode" Symbol="People" Foreground="#FF666666" />
                        </Viewbox>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <ui:SimpleStackPanel Spacing="10" Orientation="Horizontal"
                             VerticalAlignment="Bottom"
                             HorizontalAlignment="Right"
                             Height="50" Margin="10"
                             Visibility="Collapsed">
                <Button Name="BtnWhiteBoardAdd" FontFamily="Microsoft YaHei UI"
                    Width="50" Height="48" FontSize="26" Click="BtnWhiteBoardAdd_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Add" />
                </Button>
                <Button Name="BtnWhiteBoardSwitchPrevious" FontFamily="Symbol"
                    Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchPrevious_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    VerticalContentAlignment="Center"
                    IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="-90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Border Height="48" CornerRadius="2" Margin="3,0">
                    <TextBlock Name="TextBlockWhiteBoardIndexInfo"
                               Text="1 / 1"
                               Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                               VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="Microsoft YaHei UI" FontSize="18"/>
                </Border>
                <Button Name="BtnWhiteBoardSwitchNext" FontFamily="Symbol"
                    Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchNext_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    VerticalContentAlignment="Center"
                    IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Button Name="BtnWhiteBoardDelete" Click="BtnWhiteBoardDelete_Click"
                    FontFamily="Microsoft YaHei UI" Width="50" Height="48" FontSize="26"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    IsEnabled="False">
                    <ui:SymbolIcon Symbol="Delete" />
                </Button>
            </ui:SimpleStackPanel>
        </Grid>

        <Border Name="BorderSettings" Background="White" BorderBrush="Black"
                BorderThickness="1" CornerRadius="10" ui:ThemeManager.RequestedTheme="Light"
                Width="400" HorizontalAlignment="Center"
                Margin="0,80,0,120" Visibility="Visible">
            <Grid>
                <ScrollViewer Margin="0,60,0,50" VerticalScrollBarVisibility="Auto"
                              PanningMode="VerticalOnly" ui:ThemeManager.RequestedTheme="Light"
                              ManipulationBoundaryFeedback="SCManipulationBoundaryFeedback">
                    <StackPanel Margin="20,20,20,20">
                        <TextBlock FontSize="14" Margin="0,0,0,0"
                                   Text="*设置将自动保存，再次点击“设置”按钮即可关闭此页面。"/>
                        <TextBlock FontSize="14" Margin="0,0,0,12"
                                   Text="*部分设置可能需要重新打开后生效。"/>
                        <GroupBox Header="行为">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:SimpleStackPanel Spacing="12" Orientation="Horizontal">
                                    <Button Content="立即重新启动画板" Width="160" FontFamily="Microsoft YaHei UI" Click="BtnRestart_Click" Margin="0,0,0,10"/>
                                    <Button Content="立即退出" Width="160" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="0,0,0,10"/>
                                </ui:SimpleStackPanel>
                                <ui:ToggleSwitch Name="ToggleSwitchRunAtStartup" Header="开机时运行" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchRunAtStartup_Toggled"/>
                                <TextBlock Text="我们并不推荐使用 WPS Office，因为其对于触摸设备的较差支持。" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportPowerPoint" Header="Microsoft PowerPoint 支持" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportPowerPoint_Toggled"/>
                                <TextBlock Text="对 WPS Office 支持时会导致 WPS Office 关闭时卡顿，仅测试用。" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportWPS" Header="WPS Office 支持" IsOn="False" IsEnabled="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportWPS_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCanvasAtNewSlideShow" Header="开始放映时自动显示画板" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCanvasAtNewSlideShow_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="启动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoHideCanvas" Header="自动隐藏画板" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoHideCanvas_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoEnterModeFinger" Header="自动进入手指模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoEnterModeFinger_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="画板">
                            <ui:SimpleStackPanel Spacing="12">
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="InkWidthSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="20"
                                            Width="330" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="画笔粗细"
                                            IsSnapToTickEnabled="True" Value="5"
                                            TickFrequency="1" TickPlacement="Both"
                                            ValueChanged="InkWidthSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14"/>
                                </StackPanel>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCursor" Header="显示画笔光标" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCursor_Toggled"/>
                                <TextBlock Text="画笔样式"  FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                    <ComboBoxItem Content="模拟笔锋（根据墨迹尾部计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="模拟笔锋（根据速度计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="无笔锋"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <ui:ToggleSwitch Header="手指模式" IsOn="{Binding ElementName=ToggleSwitchModeFinger, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="手势">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotation" Header="允许双指旋转" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerGestureInPresentationMode" Header="允许幻灯片模式下的双指手势" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerGestureInPresentationMode_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="墨迹识别 (Beta)">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="墨迹识别功能目前处于开发阶段，目前可实现智能识别圆、三角形、&#x000A;矩形，并自动转换为规范图形。" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableInkToShape" Header="启用墨迹识别" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="True"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearance" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchTransparentButtonBackground" Header="按钮背景半透明" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchTransparentButtonBackground_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonExit" Header="显示“退出”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonExit_Toggled"/>
                                <Button Content="立即退出" Width="120" Visibility="Collapsed" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="0,0,0,10"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonEraser" Header="显示“橡皮”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonEraser_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonHideControl" Header="显示“⇅ (显示或隐藏控制按钮)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonHideControl_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonLRSwitch" Header="显示“⇆ (左右切换)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonLRSwitch_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonModeFinger" Header="显示“手指模式”切换按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonModeFinger_Toggled"/>
                                <StackPanel Visibility="Collapsed" Orientation="Horizontal">
                                    <Slider x:Name="SideControlOpacitySlider"
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="100"
                                            Width="320" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="控制栏透明度"
                                            IsSnapToTickEnabled="True" Value="100"
                                            TickFrequency="10" TickPlacement="Both"
                                            ValueChanged="SideControlOpacitySlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=SideControlOpacitySlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="25" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearanceNewUI" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Header="显示“橡皮”按钮" IsOn="{Binding ElementName=ToggleSwitchShowButtonEraser, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="高级">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比&#x000A;手掌大很多时开启" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsSpecialScreen" Header="特殊屏幕模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsSpecialScreen_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="重置">
                            <ui:SimpleStackPanel Spacing="12">
                                <StackPanel>
                                    <TextBlock FontSize="14" Margin="0,0,0,12"
                                        Text="重置设置为推荐设置"/>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Content="重置" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnResetToSuggestion_Click" Margin="0,0,0,0"/>
                                        <ui:SymbolIcon Name="SymbolIconResetSuggestionComplete" Symbol="Accept" Visibility="Collapsed"/>
                                    </ui:SimpleStackPanel>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock FontSize="14" Margin="0,0,0,12"
                                        Text="重置设置为默认设置"/>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Content="重置" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnResetToDefault_Click" Margin="0,0,0,10"/>
                                        <ui:SymbolIcon Name="SymbolIconResetDefaultComplete" Symbol="Accept" Visibility="Collapsed"/>
                                    </ui:SimpleStackPanel>
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="自动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillPptService" Header="自动查杀“PPT 小工具”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillPptService_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillEasiNote" Header="自动查杀“希沃白板 5”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillEasiNote_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="关于">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock FontSize="14">
                                        <Bold>当前版本:</Bold> 
                                    </TextBlock>
                                    <TextBlock FontSize="14" Text="" Name="TextBlockVersion"/>
                                </ui:SimpleStackPanel>
                                <TextBlock FontSize="14">
                                     <Bold>开发者:</Bold> XY Wang (WXRIW)
                                </TextBlock>
                                <TextBlock FontSize="14">
                                    <Bold>开源地址:</Bold>
                                    <Hyperlink Click="HyperlinkSource_Click">
                                           <TextBlock Text="https://github.com/WXRIW/Ink-Canvas"></TextBlock>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock FontSize="14">
                                     <Bold>开源协议:</Bold> GNU General Public License v3.0
                                </TextBlock>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxMASEZVersion"
                                  Visibility="Collapsed"
                                  Header="马鞍山二中专版说明">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Name="TextBlockMASEZNotice" FontSize="14" Margin="0,0,0,0"/>
                                <Viewbox Margin="0,0,0,0" Height="70" HorizontalAlignment="Left">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="Resources/logo.png" Width="120"/>
                                        <Image Source="Resources/text.png" Width="200"/>
                                    </StackPanel>
                                </Viewbox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
                <Grid Background="White" Margin="10,0,10,0" Height="60" VerticalAlignment="Top">
                    <Grid Margin="10,20,10,-10">
                        <TextBlock Text="设置" FontSize="26" Margin="0,0,0,12"/>
                        <!--<Viewbox Margin="0,-55,0,0" Height="60" HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="logo.png" Width="120"/>
                            <Image Source="text.png" Width="200"/>
                        </StackPanel>
                    </Viewbox>-->
                        <Viewbox Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}"
                                 Margin="0,-15,0,0" Height="45" HorizontalAlignment="Right">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="Resources/textCN.png" Width="200"/>
                                <TextBlock Text="专版" FontSize="32" Foreground="#C30F2C" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Viewbox>
                    </Grid>
                </Grid>
                <Grid VerticalAlignment="Bottom" Height="50">
                    <Button FontFamily="Microsoft YaHei UI"
                            Width="120" Margin="10"
                            HorizontalAlignment="Right"
                            Content="关闭"
                            Click="BtnSettings_Click"/>
                </Grid>
            </Grid>
        </Border>

        <Grid Name="GridNotifications" Margin="0,110" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Bottom">
            <Border CornerRadius="25" Height="50" Background="LightGray" Opacity="0.85">
                <TextBlock Name="TextBlockNotice" Text="测试文本" Margin="20,10" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
            </Border>
        </Grid>

        <Viewbox Name="ViewBoxStackPanelMain" Visibility="Visible" Margin="10,10,10,55" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="46">
            <StackPanel Name="StackPanelMain" Width="46">
                <StackPanel Name="StackPanelControl">
                    <Button Name="BtnExit" Content="退出" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnExit_Click" Background="#7F909090"/>
                    <Button Name="BtnSettings" Content="设置" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSettings_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <TextBlock Text="自动&#x000A;粗细" Visibility="Collapsed" Margin="0,10,0,0"
                           FontSize="14" HorizontalAlignment="Center"
                           Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    <!--<Viewbox Height="30" Visibility="Collapsed">
                        <ui:ToggleSwitch Name="ToggleSwitchAutoWeight" Header="" Width="40.5" 
                                     FontFamily="Microsoft YaHei UI" FontSize="19"
                                     OnContent="" OffContent="" Toggled="ToggleSwitchAutoWeight_Toggled"/>
                    </Viewbox>-->
                    <StackPanel Name="StackPanelModeFinger" Background="#01000000">
                        <TextBlock Text="手指&#x000A;模式" Margin="0,10,0,0"
                           FontSize="14" HorizontalAlignment="Center"
                           Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                        <Viewbox Height="30">
                            <ui:ToggleSwitch Name="ToggleSwitchModeFinger" Header="" Width="40.5"
                                     FontFamily="Microsoft YaHei UI" FontSize="19"
                                     OnContent="" OffContent="" Toggled="ToggleSwitchModeFinger_Toggled"/>
                        </Viewbox>
                    </StackPanel>
                    <Button Name="BtnThickness" Content="粗细" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnThickness_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button Name="BtnSwitchTheme" Content="深色" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSwitchTheme_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button Name="BtnSwitch" Content="背景" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSwitch_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <StackPanel Name="StackPanelColors" Margin="7,0,7,0">
                        <Button Name="BtnColorBlack" FontFamily="Microsoft YaHei UI" Background="Black"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlack_Click">
                            <Viewbox Name="ViewboxBtnColorBlackContent" Visibility="Collapsed">
                                <ui:SymbolIcon Symbol="Accept" Name="SymbolIconBtnColorBlackContent" Foreground="White"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorRed" FontFamily="Microsoft YaHei UI" Background="Red"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorRed_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorRedContent">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorGreen" FontFamily="Microsoft YaHei UI" Background="#169141"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorGreen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorGreenContent" Visibility="Collapsed">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorBlue" FontFamily="Microsoft YaHei UI" Background="#239AD6"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlue_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorBlueContent" Visibility="Collapsed">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorYellow" FontFamily="Microsoft YaHei UI" Background="#F38B00"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorYellow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorYellowContent" Visibility="Collapsed">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                    </StackPanel>
                    <Button Name="BtnClear" Content="清屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnHideInkCanvas" Content="隐藏&#x000A;画板" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnHideInkCanvas_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnTools" Content="工具" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnTools_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Grid Name="StackPanelToolButtons" Margin="-127,-30.5,56,0">
                        <Border CornerRadius="5" Margin="-7"
                                Background="White" Visibility="Collapsed"
                                BorderBrush="#0066BF" BorderThickness="1"/>
                        <ui:SimpleStackPanel  Orientation="Horizontal" Spacing="10">
                            <Button x:Name="BtnCountdownTimer" Content="计时器" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnCountdownTimer_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                            <Button x:Name="BtnRand" Content="抽奖" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnRand_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        </ui:SimpleStackPanel>
                    </Grid>
                    <Button x:Name="BtnScreenshot" Content="截屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnScreenshot_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnCheckPPT" Visibility="Collapsed" Content="检查" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnCheckPPT_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <StackPanel Name="StackPanelPPTButtons">
                        <Button x:Name="BtnPPTSlideShow" Visibility="Collapsed" Content="从头&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShow_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button x:Name="BtnPPTSlideShowEnd" Visibility="Collapsed" Content="结束&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShowEnd_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <StackPanel Name="StackPanelPPTControls" Visibility="Collapsed">
                            <Button x:Name="BtnPPTSlidesUp" Content="↑" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                            <Button x:Name="BtnPPTSlidesDown" Content="↓" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        </StackPanel>
                    </StackPanel>
                    <Button x:Name="BtnSwitchSide" Content="⇆" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchSide_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                </StackPanel>
                <Button x:Name="BtnHideControl" Content="⇅" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnHideControl_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <StackPanel>
                    <TextBlock Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Text="二中专版" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    <Image Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Source="Resources/logo2.png" Margin="0,-5,0,-15"/>
                    <StackPanel x:Name="StackPanelInfo">
                        <TextBlock Text="Developer" FontSize="8.5" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                        <TextBlock Text="XY Wang" FontSize="9" HorizontalAlignment="Center" Margin="0,3,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Viewbox>
        <Viewbox Name="ViewBoxStackPanelShapes" Margin="{Binding ElementName=ViewBoxStackPanelMain, Path=Margin}" Width="46" HorizontalAlignment="Left" VerticalAlignment="Bottom" Visibility="Visible">
            <StackPanel Name="StackPanelShapes" Width="46">
                <Slider HorizontalAlignment="Center" Visibility="Collapsed"
                        Minimum="1" Maximum="20" Orientation="Vertical" 
                        Height="330" FontFamily="Microsoft YaHei UI" 
                        ui:ControlHelper.Header="画笔&#x000A;粗细"
                        IsSnapToTickEnabled="True"
                        TickFrequency="1" TickPlacement="Both" 
                        RenderTransformOrigin="0.5,0.5"
                        Value="{Binding ElementName=InkWidthSlider, Path=Value, Mode=TwoWay}">
                </Slider>
                <TextBlock Text="画笔&#x000A;粗细" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                           FontSize="14" Margin="0,10,0,0" HorizontalAlignment="Center"/>
                <Button Name="BtnPenWidthIncrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,5" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthIncrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Add"/>-->
                    <Grid Margin="0,2,-5,0">
                        <TextBlock Text="&lt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <TextBlock Visibility="Visible" Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                           FontSize="14" HorizontalAlignment="Center" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                <Button Name="BtnPenWidthDecrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,5,0,0" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthDecrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Remove"/>-->
                    <Grid Margin="0,4,-5,0">
                        <TextBlock Text="&gt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <Button Name="BtnFingerDragMode" Content="单指&#x000A;拖动" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnFingerDragMode_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnSelect" Content="选择&#x000A;墨迹" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnPen" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Edit"/>
                </Button>
                <Button Name="BtnErase" Content="橡皮" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnErase_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawLine" Content="直线" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawLine_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawArrow" Content="箭头" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawArrow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawRectangle" Content="矩形" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawRectangle_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawEllipse" Content="椭圆" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawEllipse_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <StackPanel IsVisibleChanged="StackPanel_IsVisibleChanged" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                    <StackPanel Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                        <Button Content="↑" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button Content="↓" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    </StackPanel>
                </StackPanel>
                <Button Content="清屏" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button x:Name="BtnUndo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnUndo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Undo"/>
                        <TextBlock Text="撤销" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button x:Name="BtnRedo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnRedo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Redo"/>
                        <TextBlock Text="恢复" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button Name="BtnClearAndHideCanvas" Content="清屏&#x000A;&amp;&#x000A;隐藏" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}" Block.TextAlignment="Center"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Grid Name="GridForLeftSideReservedSpace" Height="{Binding ElementName=StackPanelInfo, Path=ActualHeight}"/>
            </StackPanel>
        </Viewbox>

        <Grid Name="GridForRecoverOldUI">
            <Grid Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                <Viewbox Name="ViewboxPPTSidesControl" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlPreviousPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlNextPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
                <Viewbox Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="{Binding ElementName=ViewboxPPTSidesControl, Path=Opacity}" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>
        
        <Viewbox Name="ViewboxFloatingBar" Margin="100,10,-2000,-200" 
                 HorizontalAlignment="Left" Height="50" VerticalAlignment="Top">
            <Viewbox.LayoutTransform>
                <ScaleTransform x:Name="ViewboxFloatingBarScaleTransform" ScaleX="1" ScaleY="1"/>
            </Viewbox.LayoutTransform>
            <ui:SimpleStackPanel Orientation="Horizontal">
                <Border Width="36" Height="36" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666" MouseDown="SymbolIconEmoji_MouseDown" MouseUp="SymbolIconEmoji_MouseUp">
                    <ui:SimpleStackPanel Margin="0,5,0,5" Spacing="10" Orientation="Horizontal"
                                         HorizontalAlignment="Center">
                            <ui:SymbolIcon Name="SymbolIconEmoji" Symbol="Emoji2" Foreground="#666666"/>
                    </ui:SimpleStackPanel>
                </Border>
                <Border Margin="5,0,0,0" Visibility="Visible" Height="36" Name="BorderFloatingBarMainControls" Background="#9FFFFFFF" CornerRadius="5" BorderThickness="1" BorderBrush="#BF666666">
                    <ui:SimpleStackPanel Name="StackPanelFloatingBar" Spacing="10" Orientation="Horizontal">
                        <ui:SimpleStackPanel Name="StackPanelCanvacMain" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Height="24" Width="0">
                            </Grid>
                            <local:ClickSensitiveGrid Click="SymbolIconCursor_Click" Margin="-10,0,0,0">
                                <ui:SymbolIcon Symbol="Edit" Foreground="#666666"/>
                            </local:ClickSensitiveGrid>
                            <ui:SymbolIcon Symbol="Setting" Foreground="#666666" MouseUp="SymbolIconSettings_Click"/>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="StackPanelCanvasControls" Visibility="Visible" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <local:ClickSensitiveGrid Click="SymbolIconCursor_Click">
                                <ui:SymbolIcon Symbol="TouchPointer" Foreground="#666666"/>
                            </local:ClickSensitiveGrid>
                            <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}" Spacing="8" Margin="0,1">
                                <Border Name="BorderPenColorBlack" Background="{Binding ElementName=BtnColorBlack, Path=Background}" MouseUp="BorderPenColorBlack_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorBlack, Path=ActualHeight}">
                                    <Viewbox Visibility="{Binding ElementName=ViewboxBtnColorBlackContent, Path=Visibility}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorRed" Background="{Binding ElementName=BtnColorRed, Path=Background}" MouseUp="BorderPenColorRed_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorRed, Path=ActualHeight}">
                                    <Viewbox Visibility="{Binding ElementName=ViewboxBtnColorRedContent, Path=Visibility}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorGreen" Background="{Binding ElementName=BtnColorGreen, Path=Background}" MouseUp="BorderPenColorGreen_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorGreen, Path=ActualHeight}">
                                    <Viewbox Visibility="{Binding ElementName=ViewboxBtnColorGreenContent, Path=Visibility}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorBlue" Background="{Binding ElementName=BtnColorBlue, Path=Background}" MouseUp="BorderPenColorBlue_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorBlue, Path=ActualHeight}">
                                    <Viewbox Visibility="{Binding ElementName=ViewboxBtnColorBlueContent, Path=Visibility}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorYellow" Background="{Binding ElementName=BtnColorYellow, Path=Background}" MouseUp="BorderPenColorYellow_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Visibility="{Binding ElementName=ViewboxBtnColorYellowContent, Path=Visibility}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorWhite" Background="White" CornerRadius="100" MouseUp="BorderPenColorWhite_MouseUp"
                                    Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Name="ViewboxBtnColorWhiteContent" Visibility="Collapsed" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="Black"/>
                                    </Viewbox>
                                </Border>
                            </ui:SimpleStackPanel>
                            <Grid Width="20" Height="24" Margin="0,0,-2,0" MouseUp="ImageEraser_MouseUp" Visibility="{Binding ElementName=BtnErase, Path=Visibility}">
                                <Image Margin="-2" Source="{DynamicResource ImageSource.RubberNormal}" RenderTransformOrigin="0.5,0.5">
                                    <Image.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform Angle="-45"/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Image.RenderTransform>
                                </Image>
                            </Grid>
                            <Grid Margin="0,0,0,0" Width="20">
                                <ui:SymbolIcon Symbol="Delete" Foreground="#666666" MouseUp="SymbolIconDelete_MouseUp"/>
                                <Border x:Name="BorderClearInDelete" Visibility="Collapsed" Background="White" BorderBrush="#BF666666" BorderThickness="1"
                                    CornerRadius="5" Margin="-40,-60,-40,35">
                                    <Button Content="点击清屏" ui:ThemeManager.RequestedTheme="Light"
                                        FontFamily="Microsoft YaHei UI"
                                        Width="80" HorizontalAlignment="Center"
                                        Click="BtnClear_Click"/>
                                </Border>
                            </Grid>
                            <ui:SymbolIcon Symbol="SelectAll" Foreground="#666666" MouseUp="SymbolIconSelect_MouseUp"/>
                            <Viewbox Margin="0,2">
                                <Grid>
                                    <ui:SymbolIcon Symbol="Undo" Foreground="#666666"
                                                Visibility="{Binding ElementName=BtnUndo, Path=Visibility}"
                                                IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}"
                                                MouseUp="SymbolIconUndo_MouseUp"/>
                                    <ui:SymbolIcon Symbol="Redo" Foreground="#666666"
                                                Visibility="{Binding ElementName=BtnRedo, Path=Visibility}"
                                                IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}"
                                                MouseUp="SymbolIconRedo_MouseUp"/>
                                </Grid>
                            </Viewbox>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Width="20" Height="24" Margin="2,0,12,1">
                                <Image Margin="-8" MouseUp="ImageBlackboard_MouseUp">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#666666" Geometry="F1 M64,64z M0,0z M15.125,48.875L15.125,17.375 21.875,17.375 21.875,15.125 24.125,15.125 24.125,17.375 39.875,17.375 39.875,15.125 42.125,15.125 42.125,17.375 48.875,17.375 48.875,48.875 M46.625,46.625L46.625,26.375 17.375,26.375 17.375,46.625 M17.375,24.125L46.625,24.125 46.625,19.625 42.125,19.625 42.125,21.875 39.875,21.875 39.875,19.625 24.125,19.625 24.125,21.875 21.875,21.875 21.875,19.625 17.375,19.625 17.375,24.125z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Grid>
                            <Grid Margin="0,5,0,5" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.PPTExitNormal}" Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}" MouseUp="ImagePPTControlEnd_MouseUp" Margin="-2,1,10,2"/>
                            </Grid>
                            <ui:SimpleStackPanel Margin="0,5,10,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                                <ui:SymbolIcon Margin="0,0,0,0" Symbol="Camera" Foreground="#666666" MouseUp="SymbolIconScreenshot_MouseUp"/>
                                <Grid Height="24" Width="20">
                                    <ui:SymbolIcon Symbol="Repair" Foreground="#666666" MouseUp="SymbolIconTools_MouseUp"/>
                                    <Border Name="BorderTools" Margin="37,-6,-90,-6" CornerRadius="5" Background="#9FFFFFFF" BorderThickness="1" BorderBrush="#BF666666">
                                        <ui:SimpleStackPanel Margin="10,5,0,5" Spacing="10" Orientation="Horizontal">
                                            <Grid Width="20" Height="24" Margin="0,-2,0,2">
                                                <Image Margin="-7" MouseUp="ImageCountdownTimer_MouseUp">
                                                    <Image.Source>
                                                        <DrawingImage>
                                                            <DrawingImage.Drawing>
                                                                <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                                    <DrawingGroup Opacity="1">
                                                                        <GeometryDrawing Brush="#666666" Geometry="F1 M64,64z M0,0z M42.811,22.789C44.393,24.383 45.612,26.126 46.467,28.018 47.322,29.91 47.75,31.988 47.75,34.249 47.75,35.702 47.562,37.1 47.188,38.441 46.814,39.782 46.283,41.037 45.597,42.203 44.911,43.369 44.091,44.43 43.136,45.385 42.181,46.34 41.12,47.16 39.954,47.846 38.788,48.532 37.534,49.062 36.192,49.437 34.85,49.812 33.453,50 32,50 30.547,50 29.149,49.812 27.808,49.438 26.467,49.064 25.212,48.533 24.046,47.847 22.88,47.161 21.819,46.341 20.864,45.386 19.909,44.431 19.089,43.37 18.403,42.204 17.717,41.038 17.187,39.784 16.812,38.442 16.437,37.1 16.25,35.703 16.25,34.25 16.25,32.949 16.405,31.684 16.716,30.453 17.027,29.222 17.466,28.062 18.034,26.973 18.602,25.884 19.291,24.872 20.099,23.941 20.907,23.01 21.81,22.183 22.806,21.462 23.802,20.741 24.886,20.141 26.058,19.66 27.23,19.179 28.46,18.846 29.749,18.658L29.749,16.25 25.249,16.25 25.249,14 36.5,14 36.5,16.25 32,16.25 32,18.5C33.629,18.5 35.214,18.74 36.755,19.221 38.296,19.702 39.729,20.416 41.053,21.366L44.709,17.71 46.291,19.292 42.811,22.789z M32,47.75C33.863,47.75 35.612,47.396 37.247,46.687 38.882,45.978 40.311,45.011 41.536,43.787 42.761,42.563 43.727,41.133 44.436,39.498 45.145,37.863 45.5,36.113 45.5,34.25 45.5,32.387 45.146,30.638 44.437,29.003 43.728,27.368 42.761,25.939 41.537,24.714 40.313,23.489 38.883,22.523 37.248,21.814 35.613,21.105 33.863,20.75 32,20.75 30.137,20.75 28.388,21.104 26.753,21.813 25.118,22.522 23.689,23.489 22.464,24.713 21.239,25.937 20.273,27.367 19.564,29.002 18.855,30.637 18.5,32.387 18.5,34.25 18.5,36.113 18.854,37.862 19.563,39.497 20.272,41.132 21.239,42.561 22.463,43.786 23.687,45.011 25.117,45.977 26.752,46.686 28.387,47.395 30.137,47.75 32,47.75z M38.75,34.25L38.75,36.5 29.75,36.5 29.75,25.25 32,25.25 32,34.25 38.75,34.25z" />
                                                                    </DrawingGroup>
                                                                </DrawingGroup>
                                                            </DrawingImage.Drawing>
                                                        </DrawingImage>
                                                    </Image.Source>
                                                </Image>
                                            </Grid>
                                            <ui:SymbolIcon Symbol="Shuffle" Foreground="#666666" MouseUp="SymbolIconRand_MouseUp"/>
                                        </ui:SimpleStackPanel>
                                    </Border>
                                </Grid>
                            </ui:SimpleStackPanel>
                        </ui:SimpleStackPanel>
                    </ui:SimpleStackPanel>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>
        <Grid Name="GridForFloatingBarDraging" Background="#01000000" Visibility="Collapsed"
              MouseMove="SymbolIconEmoji_MouseMove" MouseUp="SymbolIconEmoji_MouseUp"/>
    </Grid>
</Window>
